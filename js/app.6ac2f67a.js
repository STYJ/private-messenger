(function(e){function t(t){for(var r,s,c=t[0],i=t[1],u=t[2],f=0,d=[];f<c.length;f++)s=c[f],o[s]&&d.push(o[s][0]),o[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var i=n[c];0!==o[i]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/private-messenger/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},1304:function(e,t,n){"use strict";var r=n("7db8"),o=n.n(r);o.a},"14ea":function(e,t,n){"use strict";var r=n("903a"),o=n.n(r);o.a},"1e51":function(e,t,n){},2:function(e,t){},3:function(e,t){},"3be8":function(e,t,n){},4:function(e,t){},"55ef":function(e,t,n){"use strict";var r=n("f5e1"),o=n.n(r);o.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=n("bb71");n("da64");r["default"].use(o["a"],{iconfont:"md"});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{column:""}},[n("Header"),n("Body"),n("Footer")],1)],1)],1)},s=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{wrap:"",shrink:"",id:"header"}},[n("Logo"),n("v-spacer"),n("ConnectionStatus")],1)},i=[],u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-flex",{staticClass:"text-sm-center",attrs:{id:"logo_div",sm2:""}},[r("img",{attrs:{id:"logo",src:n("cf05"),alt:""}})])},l=[],f={},d=f,p=(n("88a3"),n("2877")),m=n("6544"),h=n.n(m),v=n("0e8f"),g=Object(p["a"])(d,u,l,!1,null,"a959571a",null),b=g.exports;h()(g,{VFlex:v["a"]});var w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{attrs:{xs8:"",sm6:"",md4:"",lg3:"","align-self-center":""}},[n("v-layout",{attrs:{wrap:"","justify-end":"",id:"connection-status"}},[n("ConnectButton"),n("Network"),n("Address")],1)],1)},x=[],k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{attrs:{shrink:""}},[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.connected,expression:"!connected"}],attrs:{small:""},on:{click:e.connectMetamask}},[e._v("Connect Metamask")])],1)},y=[],_=(n("96cf"),n("3b8d")),j={computed:{connected:function(){return this.$store.getters["web3/connected"]}},methods:{connectMetamask:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$store.dispatch("web3/connect");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:return e.prev=8,e.next=11,this.$store.dispatch("peerjs/init");case 11:e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](8),console.error("Unable to initialise new user.");case 16:case"end":return e.stop()}},e,this,[[0,5],[8,13]])}));function t(){return e.apply(this,arguments)}return t}()}},C=j,V=n("8336"),O=Object(p["a"])(C,k,y,!1,null,null,null),$=O.exports;h()(O,{VBtn:V["a"],VFlex:v["a"]});var T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.connected,expression:"connected"}],staticClass:"mx-1",attrs:{id:"network"}},[n("v-card",{attrs:{flat:"",color:"transparent"}},[n("v-card-text",{staticClass:"text-xs-center py-2 px-2"},[e._v("\n      "+e._s(e.network)+"\n    ")])],1)],1)},A=[],L={computed:{connected:function(){return this.$store.getters["web3/connected"]},network:function(){return this.$store.getters["web3/network"]}}},E=L,F=(n("1304"),n("b0af")),R=n("99d9"),N=Object(p["a"])(E,T,A,!1,null,"05196858",null),P=N.exports;h()(N,{VCard:F["a"],VCardText:R["a"],VFlex:v["a"]});var M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{staticClass:"mx-1",attrs:{id:"address"}},[n("v-card",{attrs:{flat:"",color:"transparent"}},[n("v-card-text",{staticClass:"text-xs-center py-2 px-2"},[e._v("\n      "+e._s(e.address)+"\n    ")])],1)],1)},S=[],B={computed:{address:function(){var e;return"Not connected"==(e=this.$store.getters["web3/address"])?e:e.slice(0,6)+"..."+e.slice(-6)}}},D=B,H=(n("bfd1"),Object(p["a"])(D,M,S,!1,null,"3e5cfea9",null)),I=H.exports;h()(H,{VCard:F["a"],VCardText:R["a"],VFlex:v["a"]});var U={components:{ConnectButton:$,Network:P,Address:I}},J=U,W=n("a722"),Y=Object(p["a"])(J,w,x,!1,null,null,null),q=Y.exports;h()(Y,{VFlex:v["a"],VLayout:W["a"]});var z={components:{Logo:b,ConnectionStatus:q}},G=z,K=(n("b2fb"),n("9910")),Q=Object(p["a"])(G,c,i,!1,null,"6bde73f8",null),X=Q.exports;h()(Q,{VLayout:W["a"],VSpacer:K["a"]});var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{id:"body"}},[n("v-flex",{attrs:{shrink:""}},[n("v-navigation-drawer",{staticClass:"transparent",attrs:{permanent:""}},[n("v-form",{on:{submit:function(t){return t.preventDefault(),e.connect(e.new_connection)}}},[n("v-layout",{attrs:{"align-center":"","justify-space-around":"",wrap:""}},[n("v-flex",{attrs:{shrink:""}},[n("v-text-field",{attrs:{placeholder:"Type address here"},model:{value:e.new_connection,callback:function(t){e.new_connection=t},expression:"new_connection"}})],1),n("v-flex",{staticClass:"text-xs-center",attrs:{md3:""}},[n("v-btn",{attrs:{fab:"",flat:"",small:"",color:"primary",type:"submit"}},[e._v("\n              Connect\n            ")])],1)],1)],1),n("v-list",{attrs:{dense:""}},e._l(e.connections,function(t){return n("v-list-tile",{key:t,on:{click:function(n){return e.setActiveConnection(t)}}},[n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t))])],1)],1)}),1)],1)],1),n("Chat",{attrs:{logs:e.logs,to:e.to},on:{submit:e.submit}})],1)},ee=[],te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{attrs:{id:"chat"}},[n("ChatHeader",{attrs:{to:e.to}}),n("v-divider"),n("ChatLog",{attrs:{logs:e.logs}}),n("ChatAction",{on:{submit:e.submit}})],1)},ne=[],re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-title",[n("v-toolbar",{attrs:{flat:"",color:"transparent",prominent:""}},[n("v-toolbar-title",[e._v("\n      "+e._s(e.to)+"\n    ")])],1)],1)},oe=[],ae={props:["to"]},se=ae,ce=n("12b2"),ie=n("71d9"),ue=n("2a7f"),le=Object(p["a"])(se,re,oe,!1,null,null,null),fe=le.exports;h()(le,{VCardTitle:ce["a"],VToolbar:ie["a"],VToolbarTitle:ue["a"]});var de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[n("v-list",{ref:"chat",attrs:{id:"logs"}},[e._l(e.logs,function(t,r){return[n("p",{key:r,staticClass:"log"},[e._v(e._s(t.id)+" : "+e._s(t.message))])]})],2)],1)},pe=[],me={props:["logs"],watch:{logs:function(){var e=this;setTimeout(function(){e.$refs.chat.$el.scrollTop=e.$refs.chat.$el.scrollHeight},0)}}},he=me,ve=(n("9a71"),n("8860")),ge=Object(p["a"])(he,de,pe,!1,null,"18072395",null),be=ge.exports;h()(ge,{VCardText:R["a"],VList:ve["a"]});var we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{staticClass:"mx-3",on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[n("v-layout",[n("v-flex",[n("v-text-field",{attrs:{placeholder:"Type message here"},model:{value:e.new_message,callback:function(t){e.new_message=t},expression:"new_message"}})],1),n("v-flex",{attrs:{"align-self-center":"",shrink:""}},[n("v-btn",{attrs:{fab:"",flat:"",small:"",color:"primary",type:"submit"}},[n("v-icon",[e._v("send")])],1)],1)],1)],1)},xe=[],ke={data:function(){return{new_message:""}},methods:{submit:function(){this.$emit("submit",this.new_message),this.new_message=""}}},ye=ke,_e=n("4bd4"),je=n("132d"),Ce=n("2677"),Ve=Object(p["a"])(ye,we,xe,!1,null,"5da71bdc",null),Oe=Ve.exports;h()(Ve,{VBtn:V["a"],VFlex:v["a"],VForm:_e["a"],VIcon:je["a"],VLayout:W["a"],VTextField:Ce["a"]});var $e={props:["logs","to"],components:{ChatHeader:fe,ChatLog:be,ChatAction:Oe},methods:{submit:function(e){this.$emit("submit",e)}}},Te=$e,Ae=(n("b065"),n("ce7e")),Le=Object(p["a"])(Te,te,ne,!1,null,"489c1602",null),Ee=Le.exports;h()(Le,{VDivider:Ae["a"],VFlex:v["a"]});var Fe={data:function(){return{new_connection:"",to:"Privacy focused messenging app",logs:[{id:"Admin",message:"Hi!"},{id:"Admin",message:"Please read the following instructions before proceeding."},{id:"Admin",message:"This dapp currently a WIP and only works with metamask. Ensure that you have metamask installed."},{id:"Admin",message:"If you were accidentally or intentionally refresh your tab, you will lose all your chat history."},{id:"Admin",message:"To get started, click on the 'Connect Metamask' button."},{id:"Admin",message:"If the dapp is not enabled, a prompt will be triggered to request for permission to connect."},{id:"Admin",message:"After enabling it, enter an Ethereum address into the input field and click connect. Note that this address must also be currently connected to the dapp."},{id:"Admin",message:"VoilÃ ! You're done. Click on the address and start communicating!."}]}},components:{Chat:Ee},computed:{connections:function(){return this.$store.getters["peerjs/connections"]}},methods:{createMessage:function(e,t){return{id:e.slice(0,6)+"...",message:t}},updateLogs:function(){this.logs=this.to?this.$store.getters["peerjs/logs"][this.to]:[]},setActiveConnection:function(e){this.to=e,this.updateLogs()},submit:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=19;break}if(n=this.$store.getters["peerjs/peer"],null===n){e.next=16;break}if(r=this.createMessage(n.id,t),!(n.connections[this.to].length>0&&n.connections[this.to][0].open)){e.next=12;break}return n.connections[this.to][0].send(r),o=this.$store.getters["peerjs/logs"],o[this.to].push(r),e.next=10,this.$store.dispatch("peerjs/setLogs",o);case 10:e.next=13;break;case 12:console.error("".concat(this.to," is no longer active."));case 13:this.updateLogs(),e.next=17;break;case 16:console.error("Error peer undefined! Please initiate a new peer.");case 17:e.next=20;break;case 19:console.error("Message length cannot be 0.");case 20:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),connect:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("peerjs/connect",t);case 2:this.new_connection="";case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},Re=Fe,Ne=(n("55ef"),n("ba95")),Pe=n("5d23"),Me=n("f774"),Se=Object(p["a"])(Re,Z,ee,!1,null,"1ddb2202",null),Be=Se.exports;h()(Se,{VBtn:V["a"],VFlex:v["a"],VForm:_e["a"],VLayout:W["a"],VList:ve["a"],VListTile:Ne["a"],VListTileContent:Pe["a"],VListTileTitle:Pe["b"],VNavigationDrawer:Me["a"],VTextField:Ce["a"]});var De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{"justify-space-around":"",shrink:"",wrap:"",id:"footer"}},[n("v-flex",{attrs:{shrink:""}},[n("v-btn",{attrs:{icon:"",href:"https://github.com/STYJ/encrypt-my-data",target:"_blank"}},[n("v-icon",[e._v("fab fa-github")])],1)],1),n("v-flex",{attrs:{shrink:""}},[n("v-btn",{attrs:{icon:"",href:"https://facebook.com",target:"_blank"}},[n("v-icon",[e._v("fab fa-facebook")])],1)],1),n("v-flex",{attrs:{shrink:""}},[n("v-btn",{attrs:{icon:"",href:"https://twitter.com",target:"_blank"}},[n("v-icon",[e._v("fab fa-twitter")])],1)],1),n("v-flex",{attrs:{shrink:""}},[n("v-btn",{attrs:{icon:"",href:"https://linkedin.com",target:"_blank"}},[n("v-icon",[e._v("fab fa-linkedin")])],1)],1)],1)},He=[],Ie={},Ue=Ie,Je=(n("14ea"),Object(p["a"])(Ue,De,He,!1,null,"08717552",null)),We=Je.exports;h()(Je,{VBtn:V["a"],VFlex:v["a"],VIcon:je["a"],VLayout:W["a"]});var Ye={name:"App",components:{Header:X,Body:Be,Footer:We},data:function(){return{}}},qe=Ye,ze=n("7496"),Ge=n("a523"),Ke=Object(p["a"])(qe,a,s,!1,null,null,null),Qe=Ke.exports;h()(Ke,{VApp:ze["a"],VContainer:Ge["a"],VLayout:W["a"]});var Xe=n("2f62"),Ze={network:function(e){return e.network},address:function(e){return e.address},web3:function(e){return e.web3},connected:function(e){return e.connected}},et=n("e573"),tt=n.n(et);function nt(e){return rt.apply(this,arguments)}function rt(){return rt=Object(_["a"])(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=window.ethereum,!o){e.next=30;break}return a=new tt.a(o),e.prev=3,e.next=6,o.enable();case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),console.error("User rejected access");case 12:if("undefined"===typeof n){e.next=29;break}return e.prev=13,e.next=16,a.eth.net.getNetworkType();case 16:r=e.sent,e.next=22;break;case 19:e.prev=19,e.t1=e["catch"](13),console.error("Network error");case 22:a.eth.currentProvider.on("accountsChanged",function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.utils.toChecksumAddress(n[0]),t.commit("setAddress",r),e.next=4,t.dispatch("peerjs/init",null,{root:!0});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),t.commit("setWeb3",a),t.commit("setAddress",a.utils.toChecksumAddress(n[0])),t.commit("setNetwork",r.localeCompare("main")?r:"Mainnet"),t.commit("connect"),e.next=30;break;case 29:console.error("Metamask connection failed, please try again.");case 30:case"end":return e.stop()}},e,null,[[3,9],[13,19]])})),rt.apply(this,arguments)}function ot(e){return at.apply(this,arguments)}function at(){return at=Object(_["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,nt(t);case 2:case"end":return e.stop()}},e)})),at.apply(this,arguments)}var st={connect:ot},ct={setWeb3:function(e,t){return e.web3=t},setAddress:function(e,t){return e.address=t},setNetwork:function(e,t){return e.network=t},connect:function(e){return e.connected=!0},disconnect:function(e){return e.connected=!1}},it=function(){return{web3:null,address:"Not connected",network:"",connected:!1}},ut={namespaced:!0,state:it,getters:Ze,actions:st,mutations:ct},lt={peer:function(e){return e.peer},connections:function(e){return e.connections},logs:function(e){return e.logs}},ft=n("a0bc"),dt=n.n(ft);function pt(e){var t=e.rootState.web3.address,n=new dt.a(t,{debug:2});mt(e,n),e.commit("setPeer",n)}function mt(e,t){t.on("open",function(e){console.log("Peer ".concat(e," initiated"))}),t.on("connection",function(n){console.log("Peer ".concat(t.id," received an incoming connection from ").concat(n.peer)),vt(e,t,n)}),t.on("call",function(e){console.log("I haven't figured out how to handle calls ".concat(e))}),t.on("close",function(){t.destroy(),console.log("Peer ".concat(t.id," closed and destroyed."))}),t.on("disconnected",function(){console.log("Connection lost. Trying to reconnect..."),t.reconnect()}),t.on("error",function(e){console.error(e)})}function ht(e,t){var n=e.getters.peer;if(console.log("".concat(n.id," wants to connect to ").concat(t)),t==n.id)console.error("Can't connect to self.");else{var r=n.connect(t);vt(e,n,r)}}function vt(e,t,n){console.log("You: ".concat(t.id,", them: ").concat(n.peer)),n.on("open",function(){var r=e.getters.logs;r[n.peer]=[],e.commit("setLogs",r),n.on("data",function(t){var r=e.getters.logs;r[n.peer].push(t),e.commit("setLogs",r)}),n.on("close",function(){console.log("Connection with ".concat(n.peer," has been closed."))}),n.on("error",function(e){console.log(e)}),e.commit("setPeer",t),e.commit("setConnections"),console.log("End of setup, new connection established to ".concat(n.peer))})}function gt(e){return bt.apply(this,arguments)}function bt(){return bt=Object(_["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:pt(t);case 1:case"end":return e.stop()}},e)})),bt.apply(this,arguments)}function wt(e,t){return xt.apply(this,arguments)}function xt(){return xt=Object(_["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:ht(t,n);case 1:case"end":return e.stop()}},e)})),xt.apply(this,arguments)}function kt(e,t){return yt.apply(this,arguments)}function yt(){return yt=Object(_["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.commit("setLogs",n);case 1:case"end":return e.stop()}},e)})),yt.apply(this,arguments)}var _t={init:gt,connect:wt,setLogs:kt},jt=(n("ac6a"),n("456d"),{setPeer:function(e,t){return e.peer=t},setConnections:function(e){return e.connections=Object.keys(e.peer.connections)},setLogs:function(e,t){return e.logs=t}}),Ct=function(){return{peer:null,connections:[],logs:{}}},Vt={namespaced:!0,state:Ct,getters:lt,actions:_t,mutations:jt};r["default"].use(Xe["a"]);var Ot=new Xe["a"].Store({modules:{web3:ut,peerjs:Vt}}),$t=Ot,Tt=n("9483");Object(Tt["a"])("".concat("/private-messenger/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var At=n("ce5b"),Lt=n.n(At);n("15f5");r["default"].use(Lt.a,{iconfont:"fa"}),r["default"].config.productionTip=!1,new r["default"]({store:$t,render:function(e){return e(Qe)}}).$mount("#app")},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"},"73a2":function(e,t,n){},"7db8":function(e,t,n){},"88a3":function(e,t,n){"use strict";var r=n("ee43"),o=n.n(r);o.a},"903a":function(e,t,n){},"9a71":function(e,t,n){"use strict";var r=n("73a2"),o=n.n(r);o.a},b065:function(e,t,n){"use strict";var r=n("1e51"),o=n.n(r);o.a},b2fb:function(e,t,n){"use strict";var r=n("3be8"),o=n.n(r);o.a},bfd1:function(e,t,n){"use strict";var r=n("ffa0"),o=n.n(r);o.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.59c0ab45.png"},ee43:function(e,t,n){},f5e1:function(e,t,n){},ffa0:function(e,t,n){}});
//# sourceMappingURL=app.6ac2f67a.js.map